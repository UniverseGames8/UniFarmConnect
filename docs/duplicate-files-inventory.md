# Инвентаризация дублирующих файлов в проекте UniFarm

## Модули базы данных

| Основной файл | Дублирующие файлы | Статус | Рекомендация |
|---------------|-------------------|--------|--------------|
| `db.ts` | - | Актуальный | Сохранить как точку входа |
| `db-selector.ts` | `db-selector-new.ts` | Вероятно, новая версия селектора | Сравнить и выбрать актуальную версию |
| `db-connect.ts` | `db-alt.ts`, `db-standard.ts`, `db-override.ts` | Альтернативные реализации | Консолидировать в один модуль |
| - | `db-neon.ts`, `db-replit.ts` | Специфические реализации | Определить актуальность и консолидировать в единый модуль подключения |
| `db-health.ts` | `db-monitor.ts` | Дублирующиеся модули мониторинга | Объединить функциональность |
| - | `server/api/db-monitor.ts`, `server/api/db-status.ts` | API-эндпоинты для статуса БД | Оставить, но обновить зависимости |

## Контроллеры

| Основной файл | Дублирующие файлы | Статус | Рекомендация |
|---------------|-------------------|--------|--------------|
| `authController.ts` | `authController.new.ts` | Вероятно, незавершенная миграция | Сравнить и выбрать актуальную версию |
| `boostController.ts` | `boostControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `dailyBonusController.ts` | `dailyBonusControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `missionController.ts` | `missionControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `referralController.ts` | `referralControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `tonBoostController.ts` | `tonBoostControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `userController.ts` | `userControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| `walletController.ts` | `walletControllerFallback.ts` | Резервные контроллеры | Определить актуальность |
| - | `newUniFarmingController.ts` | Новая версия контроллера | Определить, заменяет ли farmingController |

## Сервисы

| Основной файл | Дублирующие файлы | Статус | Рекомендация |
|---------------|-------------------|--------|--------------|
| Сервисы с суффиксом `.ts` | Сервисы с суффиксом `Instance.ts` | Прокси и экземпляры | Сохранить, часть архитектуры |
| `sessionService.ts` | `session-service-original.ts` | Оригинал и новая версия | Определить актуальность |
| `transactionService.ts` | `transaction-service-original.ts` | Оригинал и новая версия | Определить актуальность |
| `userService.ts` | `user-service-original.ts` | Оригинал и новая версия | Определить актуальность |
| `referralBonusProcessor.ts` | `optimizedReferralBonusProcessor.ts`, `standardReferralBonusProcessor.ts` | Разные реализации | Определить актуальную версию |
| `partition-service.ts` | `partitionService.ts` | Дублирующиеся сервисы | Определить актуальную версию |

## Маршруты API

| Основной файл | Дублирующие файлы | Статус | Рекомендация |
|---------------|-------------------|--------|--------------|
| `routes.ts` | `routes-new.ts`, `routes-fixed.ts` | Разные версии | Определить актуальную версию |

## Хранилище данных

| Основной файл | Дублирующие файлы | Статус | Рекомендация |
|---------------|-------------------|--------|--------------|
| `storage.ts` | `storage-standard.ts` | Разные реализации | Определить актуальную версию |
| - | `storage-adapter.ts`, `storage-adapter-extended.ts` | Адаптеры | Определить необходимость |

## Выводы и рекомендации

1. **Модули базы данных**: Наиболее критическая область с множеством дублирующихся файлов. Требуется консолидация.
2. **Контроллеры**: Присутствуют основные и резервные (fallback) версии. Необходимо определить актуальность и удалить ненужные.
3. **Сервисы**: Структура с Instance/Service паттерном выглядит согласованной, но есть отдельные файлы с суффиксами -original, требующие проверки.
4. **Маршруты API**: Несколько версий файлов маршрутизации требуют консолидации.
5. **Хранилище данных**: Несколько реализаций хранилища требуют определения актуальной версии.

### План консолидации

1. Создать новый модуль `db-config.ts` для конфигурации базы данных
2. Объединить `db-health.ts` и `db-monitor.ts` в единый модуль мониторинга
3. Консолидировать все файлы подключения к базе данных в единую структуру
4. Сравнить и выбрать актуальные версии контроллеров, удалив устаревшие
5. Стандартизировать именование файлов во всем проекте
