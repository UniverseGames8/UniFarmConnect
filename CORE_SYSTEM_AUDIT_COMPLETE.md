# üìã –û–¢–ß–ï–¢: –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —è–¥—Ä–∞ UniFarm –∑–∞–≤–µ—Ä—à–µ–Ω

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:** 01.06.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù

## üîß –ê–£–î–ò–¢ –°–ò–°–¢–ï–ú–ù–û–ì–û –Ø–î–†–ê (core/)

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

**1. –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è core/ —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–∞–ª–æ–Ω—É:**
```
core/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts          ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ–Ω—Ñ–∏–≥–∏
‚îú‚îÄ‚îÄ db.ts                 ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ Neon
‚îú‚îÄ‚îÄ logger.ts             ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts           ‚úÖ Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Telegram initData + JWT)
‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.ts   ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ validate.ts       ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Zod)
‚îî‚îÄ‚îÄ index.ts              ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

**2. –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ñ–∞–π–ª–æ–≤:**
- ‚ùå –£–¥–∞–ª–µ–Ω `core/db/` (—Å—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- ‚ùå –£–¥–∞–ª–µ–Ω `core/server.ts` (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ –≥–ª–∞–≤–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞)
- ‚ùå –£–¥–∞–ª–µ–Ω—ã `core/middleware/cors.ts`, `error.ts`, `logger.ts` (–¥—É–±–ª–∏)
- ‚ùå –£–¥–∞–ª–µ–Ω `core/middleware/index.ts` (–∑–∞–º–µ–Ω–µ–Ω –Ω–∞ core/index.ts)

**3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ production –±–∞–∑–µ:**
- ‚úÖ `core/db.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Neon PostgreSQL
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π DATABASE_URL
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Drizzle ORM

**4. Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- ‚úÖ `authenticateTelegram()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram initData
- ‚úÖ `authenticateJWT()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ `optionalAuth()` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ Telegram WebApp

**5. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚úÖ `globalErrorHandler()` - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ `notFoundHandler()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ 404 –æ—à–∏–±–æ–∫
- ‚úÖ `asyncHandler()` - wrapper –¥–ª—è async —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫

---

## üìÅ –ê–£–î–ò–¢ –ë–ò–ó–ù–ï–°-–ú–û–î–£–õ–ï–ô (modules/)

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö 10 –º–æ–¥—É–ª–µ–π:

**–ú–æ–¥—É–ª–∏ —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:**
1. **admin/** - ‚úÖ controller, service, routes, model, types
2. **auth/** - ‚úÖ controller, service, routes, model, types
3. **boost/** - ‚úÖ + logic/tonBoostCalculation.ts
4. **dailyBonus/** - ‚úÖ controller, service, routes, model, types
5. **farming/** - ‚úÖ + logic/rewardCalculation.ts
6. **missions/** - ‚úÖ controller, service, routes, model, types
7. **referral/** - ‚úÖ + logic/deepReferral.ts, rewardDistribution.ts
8. **telegram/** - ‚úÖ controller, service, routes, model, types
9. **user/** - ‚úÖ controller, service, routes, model, types
10. **wallet/** - ‚úÖ + logic/transactions.ts, withdrawals.ts

### ‚úÖ –û—á–∏—Å—Ç–∫–∞ –º–æ–¥—É–ª–µ–π:
- ‚ùå –£–¥–∞–ª–µ–Ω `modules/telegram/middleware.ts` (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ core)
- ‚ùå –£–¥–∞–ª–µ–Ω `modules/telegram/utils.ts` (—Ñ—É–Ω–∫—Ü–∏–∏ –≤ core)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏: –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ backup-—Ñ–∞–π–ª–æ–≤: –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

### ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:
**–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç:**
- `controller.ts` - ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `service.ts` - ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- `routes.ts` - ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã API
- `model.ts` - ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (–≥–¥–µ –Ω—É–∂–Ω–æ)
- `types.ts` - ‚úÖ –¢–∏–ø—ã TypeScript
- `logic/` - ‚úÖ –°–ª–æ–∂–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–£–î–ò–¢–ê

### ‚úÖ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø:
1. **–°–∏—Å—Ç–µ–º–Ω–æ–µ —è–¥—Ä–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¢–ó**
2. **–í—Å–µ 10 –º–æ–¥—É–ª–µ–π –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É**
3. **–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**
4. **–ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**
5. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ production –ë–î –∞–∫—Ç—É–∞–ª—å–Ω–æ**
6. **Middleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**

### üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –º–æ–¥—É–ª–µ–π:** 10/10
- **–£–¥–∞–ª–µ–Ω–æ –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤:** 7
- **–°–æ–∑–¥–∞–Ω–æ core —Ñ–∞–π–ª–æ–≤:** 5
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω—É:** 100%

### üöÄ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ü–†–û–î–ê–ö–®–ï–ù–£:
- ‚úÖ Core —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞
- ‚úÖ –ú–æ–¥—É–ª–∏ –æ—á–∏—â–µ–Ω—ã –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç—É–∞–ª—å–Ω–∞
- ‚úÖ Middleware —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìã –ò–¢–û–ì–û–í–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —è–¥—Ä–∞ –∏ –º–æ–¥—É–ª–µ–π UniFarm –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó ‚Ññ2 –∏ ‚Ññ3.**

–°–∏—Å—Ç–µ–º–∞ –Ω–∞ 100% –≥–æ—Ç–æ–≤–∞ –∫ –¥–µ–ø–ª–æ—é:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ core/ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç—Ç–∞–ª–æ–Ω—É
- –í—Å–µ –º–æ–¥—É–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥—É–±–ª–∏ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∞–∫—Ç—É–∞–ª—å–Ω–æ
- Middleware –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞: –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£** üéâ